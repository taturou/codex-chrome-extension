prefix_rule(pattern=["codex", "app-server"], decision="allow")
prefix_rule(pattern=["node", "/tmp/ws-client/capture.js"], decision="allow")
prefix_rule(pattern=["node", "-e", "const WebSocket=require(\"ws\"); const ws=new WebSocket(\"ws://127.0.0.1:44444\",{perMessageDeflate:false}); ws.on(\"open\",()=>{console.log(\"OPEN\"); ws.close();}); ws.on(\"error\",(e)=>{console.error(\"ERR\",e.message); process.exit(1);}); ws.on(\"close\",(c,r)=>{console.log(\"CLOSE\",c,String(r)); process.exit(0);});"], decision="allow")
prefix_rule(pattern=["node", "-e", "const WebSocket=require(\"/tmp/ws-client/node_modules/ws\"); const ws=new WebSocket(\"ws://127.0.0.1:43171\",{perMessageDeflate:false}); ws.on(\"open\",()=>{console.log(\"OPEN_ONLY\"); setTimeout(()=>ws.close(),1000);}); ws.on(\"message\",d=>console.log(\"MSG\",String(d).slice(0,200))); ws.on(\"error\",e=>console.log(\"ERR_ONLY\",e.message)); ws.on(\"close\",(c,r)=>console.log(\"CLOSE_ONLY\",c,String(r))); setTimeout(()=>process.exit(0),5000);"], decision="allow")
prefix_rule(pattern=["node", "-e", "const WebSocket=require(\"/tmp/ws-client/node_modules/ws\"); const ws=new WebSocket(\"ws://127.0.0.1:43171\",{perMessageDeflate:false}); ws.on(\"open\",()=>{console.log(\"OPEN_INIT\"); ws.send(JSON.stringify({jsonrpc:\"2.0\",id:\"1\",method:\"initialize\",params:{clientInfo:{name:\"probe\",title:\"probe\",version:\"0.0.1\"},capabilities:{experimentalApi:false}}})); ws.send(JSON.stringify({jsonrpc:\"2.0\",method:\"initialized\"}));}); ws.on(\"message\",d=>console.log(\"MSG_INIT\",String(d).slice(0,400))); ws.on(\"error\",e=>console.log(\"ERR_INIT\",e.message)); ws.on(\"close\",(c,r)=>console.log(\"CLOSE_INIT\",c,String(r))); setTimeout(()=>process.exit(0),5000);"], decision="allow")
prefix_rule(pattern=["node", "scripts/ws-proxy.mjs"], decision="allow")
